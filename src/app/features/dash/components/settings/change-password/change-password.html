<section class="flex items-center justify-center p-4">
  <div class="relative w-full max-w-2xl">
    <div class="overflow-hidden rounded-2xl bg-white shadow-xl">
      <div class="overflow-hidden rounded-[1.75rem] bg-white p-10 shadow-2xl">
        <!-- Header -->
        <h1 class="mb-8 text-3xl font-bold text-slate-800">Cambiar contraseña</h1>

        <!-- Formulario -->
        <form class="space-y-6" [formGroup]="passwordForm" (ngSubmit)="onSubmit()">
          <!-- Contraseña actual -->
          <div class="relative">
            <input
              [type]="showCurrent() ? 'text' : 'password'"
              formControlName="currentPassword"
              class="peer w-full rounded-lg border border-slate-300 bg-transparent px-3 pt-5 pr-10 pb-2 text-sm text-slate-900 focus:border-blue-600 focus:ring-0 focus:outline-none"
            />

            <label
              class="pointer-events-none absolute top-2 left-3 text-sm text-slate-500 transition-all duration-200 peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-slate-400 peer-focus:top-1 peer-focus:text-xs peer-focus:text-blue-600"
            >
              Contraseña actual
            </label>

            <button
              type="button"
              (click)="toggleCurrent()"
              class="absolute top-1/2 right-3 -translate-y-1/2 text-slate-500 hover:text-slate-700"
              tabindex="-1"
            >
              @if (showCurrent()) {
                <closed-eye-icon />
              } @else {
                <eye-icon />
              }
            </button>

            @if (currentPasswordError) {
              <p class="mt-1 text-xs text-red-600">Requerido.</p>
            }
          </div>

          <!-- Nueva contraseña -->
          <div class="relative">
            <input
              [type]="showNew() ? 'text' : 'password'"
              formControlName="newPassword"
              class="peer w-full rounded-lg border border-slate-300 bg-transparent px-3 pt-5 pr-10 pb-2 text-sm text-slate-900 focus:border-blue-600 focus:ring-0 focus:outline-none"
            />

            <label
              class="pointer-events-none absolute top-2 left-3 text-sm text-slate-500 transition-all duration-200 peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-slate-400 peer-focus:top-1 peer-focus:text-xs peer-focus:text-blue-600"
            >
              Nueva contraseña
            </label>

            <button
              type="button"
              (click)="toggleNew()"
              class="absolute top-1/2 right-3 -translate-y-1/2 text-slate-500 hover:text-slate-700"
              tabindex="-1"
            >
              @if (showNew()) {
                <closed-eye-icon />
              } @else {
                <eye-icon />
              }
            </button>

            @if (newPasswordError) {
              <p class="mt-1 text-xs text-red-600">
                Mínimo 8 caracteres, con mayúscula, minúscula y número.
              </p>
            }
          </div>

          <!-- Confirmar nueva contraseña -->
          <div class="relative">
            <input
              [type]="showConfirm() ? 'text' : 'password'"
              formControlName="confirmPassword"
              class="peer w-full rounded-lg border border-slate-300 bg-transparent px-3 pt-5 pr-10 pb-2 text-sm text-slate-900 focus:border-blue-600 focus:ring-0 focus:outline-none"
            />

            <label
              class="pointer-events-none absolute top-2 left-3 text-sm text-slate-500 transition-all duration-200 peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-slate-400 peer-focus:top-1 peer-focus:text-xs peer-focus:text-blue-600"
            >
              Confirmar nueva contraseña
            </label>

            <button
              type="button"
              (click)="toggleConfirm()"
              class="absolute top-1/2 right-3 -translate-y-1/2 text-slate-500 hover:text-slate-700"
              tabindex="-1"
            >
              @if (showConfirm()) {
                <closed-eye-icon />
              } @else {
                <eye-icon />
              }
            </button>

            @if (confirmPasswordError) {
              <p class="mt-1 text-xs text-red-600">Las contraseñas no coinciden.</p>
            }
          </div>

          <button
            type="submit"
            class="w-full rounded-lg bg-blue-600 py-3 text-sm font-medium text-white transition-all duration-200 hover:bg-blue-700 disabled:cursor-not-allowed disabled:bg-gray-300 disabled:text-gray-500"
            [disabled]="passwordForm.invalid || isLoading()"
          >
            {{ isLoading() ? 'Guardando...' : 'Actualizar contraseña' }}
          </button>
        </form>
      </div>
    </div>
  </div>
</section>
