<h1 class="mb-8 text-3xl font-bold text-slate-800">Iniciar sesión</h1>

<form class="space-y-6" [formGroup]="loginForm" (submit)="onSubmit()">
  <!-- Email -->
  <div class="relative">
    <input
      type="email"
      formControlName="email"
      class="peer w-full rounded-lg border border-slate-300 bg-transparent px-3 pt-5 pb-2 text-sm text-slate-900 focus:border-blue-600 focus:ring-0 focus:outline-none"
    />
    <label
      class="pointer-events-none absolute top-2 left-3 text-sm text-slate-500 transition-all duration-200 peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-slate-400 peer-focus:top-1 peer-focus:text-xs peer-focus:text-blue-600"
    >
      Email
    </label>

    @if (email.invalid && email.touched) {
      <p class="mt-1 text-xs text-red-600">Email inválido</p>
    }
  </div>

  <!-- Password -->
  <div class="relative">
    <div class="relative">
      <input
        [type]="showPassword() ? 'text' : 'password'"
        formControlName="password"
        class="peer w-full rounded-lg border border-slate-300 bg-transparent px-3 pt-5 pr-10 pb-2 text-sm text-slate-900 focus:border-blue-600 focus:ring-0 focus:outline-none"
      />
      <label
        class="pointer-events-none absolute top-2 left-3 text-sm text-slate-500 transition-all duration-200 peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-slate-400 peer-focus:top-1 peer-focus:text-xs peer-focus:text-blue-600"
      >
        Contraseña
      </label>

      <button
        type="button"
        (click)="togglePassword()"
        class="absolute top-1/2 right-3 -translate-y-1/2 text-slate-500 hover:text-slate-700"
        tabindex="-1"
      >
        @if (showPassword()) {
          <closed-eye-icon />
        } @else {
          <eye-icon />
        }
      </button>
    </div>

    @if (password.invalid && password.touched) {
      <p class="mt-1 text-xs text-red-600">
        Contraseña inválida. Debe contener al menos una letra mayúscula, una letra minúscula y un
        número y tener entre 8 y 20 caracteres.
      </p>
    }
  </div>

  <!-- Forgot -->
  <div class="flex justify-end text-sm">
    <button
      routerLink="/auth/forgot"
      type="button"
      class="cursor-pointer text-blue-600 hover:underline"
    >
      ¿Olvidaste tu contraseña?
    </button>
  </div>

  <!-- Submit -->
  <button
    type="submit"
    class="w-full rounded-lg bg-blue-600 py-3 text-sm font-medium text-white transition-all duration-200 hover:bg-blue-700 disabled:cursor-not-allowed disabled:bg-gray-300 disabled:text-gray-500"
    [disabled]="loginForm.invalid || loading()"
  >
    {{ loading() ? 'Cargando...' : 'Entrar' }}
  </button>

  @if (error()) {
    <p class="text-center text-sm text-red-600">
      {{ error() }}
    </p>
  }
</form>

<p class="mt-8 text-center text-xs text-slate-500">
  Si no tienes cuenta, contacta con la administración.
</p>
