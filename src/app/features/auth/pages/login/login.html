<h1 class="mb-8 text-3xl font-bold text-slate-800 dark:text-white">Iniciar sesión</h1>

<form class="space-y-6" [formGroup]="loginForm" (submit)="onSubmit()">
  <div class="relative">
    <input
      type="email"
      formControlName="email"
      placeholder=" "
      class="peer w-full rounded-lg border border-slate-300 bg-transparent px-3 pt-5 pb-2 text-sm text-slate-900 focus:border-blue-600 focus:ring-0 focus:outline-none dark:border-slate-700 dark:text-white dark:focus:border-blue-500"
    />
    <label
      class="pointer-events-none absolute top-2 left-3 text-sm text-slate-500 transition-all duration-200 peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-slate-400 peer-focus:top-1 peer-focus:text-xs peer-focus:text-blue-600 dark:text-slate-400 dark:peer-focus:text-blue-400"
    >
      Email
    </label>

    @if (email.invalid && email.touched) {
      <p class="mt-1 text-xs text-red-600 dark:text-red-400">Email inválido</p>
    }
  </div>

  <div class="relative">
    <div class="relative">
      <input
        [type]="showPassword() ? 'text' : 'password'"
        formControlName="password"
        placeholder=" "
        class="peer w-full rounded-lg border border-slate-300 bg-transparent px-3 pt-5 pr-10 pb-2 text-sm text-slate-900 focus:border-blue-600 focus:ring-0 focus:outline-none dark:border-slate-700 dark:text-white dark:focus:border-blue-500"
      />
      <label
        class="pointer-events-none absolute top-2 left-3 text-sm text-slate-500 transition-all duration-200 peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-slate-400 peer-focus:top-1 peer-focus:text-xs peer-focus:text-blue-600 dark:text-slate-400 dark:peer-focus:text-blue-400"
      >
        Contraseña
      </label>

      <button
        type="button"
        (click)="togglePassword()"
        class="absolute top-1/2 right-3 -translate-y-1/2 text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"
        tabindex="-1"
      >
        @if (showPassword()) {
          <closed-eye-icon />
        } @else {
          <eye-icon />
        }
      </button>
    </div>

    @if (password.invalid && password.touched) {
      <p class="mt-1 text-xs text-red-600 dark:text-red-400">
        Contraseña inválida. Debe contener al menos una letra mayúscula, una letra minúscula y un
        número y tener entre 8 y 20 caracteres.
      </p>
    }
  </div>

  <div class="flex items-center justify-between text-sm">
    <label class="flex cursor-pointer items-center">
      <input
        type="checkbox"
        formControlName="rememberMe"
        class="mr-2 h-4 w-4 cursor-pointer appearance-none rounded border-2 border-slate-300 bg-white text-blue-600 transition-colors checked:border-blue-600 checked:bg-blue-600 hover:border-blue-400 checked:hover:bg-blue-700 dark:border-slate-600 dark:bg-slate-800 dark:checked:border-blue-500 dark:checked:bg-blue-600 dark:hover:border-blue-500 dark:checked:hover:bg-blue-500"
      />
      <span class="text-slate-700 dark:text-slate-300">Recordarme</span>
    </label>

    <button
      routerLink="/auth/forgot"
      type="button"
      class="cursor-pointer text-blue-600 hover:underline dark:text-blue-400"
    >
      ¿Olvidaste tu contraseña?
    </button>
  </div>

  <button
    type="submit"
    class="w-full rounded-lg bg-blue-600 py-3 text-sm font-medium text-white transition-all duration-200 hover:bg-blue-700 disabled:cursor-not-allowed disabled:bg-gray-300 disabled:text-gray-500 dark:bg-blue-600 dark:hover:bg-blue-500 dark:disabled:bg-slate-800 dark:disabled:text-slate-600"
    [disabled]="loginForm.invalid || loading()"
  >
    {{ loading() ? 'Cargando...' : 'Entrar' }}
  </button>

  @if (error()) {
    <p class="text-center text-sm text-red-600 dark:text-red-400">
      {{ error() }}
    </p>
  }
</form>

<p class="mt-8 text-center text-xs text-slate-500 dark:text-slate-400">
  Si no tienes cuenta, contacta con la administración.
</p>
